language: python

python:
    - "2.7"

before_install:
  # required dependency for sphinx
  - sudo apt-get install -y pandoc

install:
  #
  # install pyside for Qt.py - from https://stackoverflow.com/questions/24489588
  - sudo apt-get install -y libqt4-dev
  - pip install PySide --no-index --find-links https://parkin.github.io/python-wheelhouse/;
  - python ~/virtualenv/python${TRAVIS_PYTHON_VERSION}/bin/pyside_postinstall.py -install
  #
  # Documentation dependencies
  - pip install -r ./docs/requirements.txt

script:
  # Generate docs
  - sphinx-apidoc -o ./docs/api --separate --no-toc ./
  - sphinx-apidoc -o ./docs/api/hooks --separate --tocfile index ./hooks
  - sphinx-build ./docs ./docs/_build

deploy:
  # When committing to master, auto-deploy to github-pages
  # This will copy the contents of the _build folder to gh-pages branch and push
- provider: pages
  local-dir: ./docs/_build
  target-branch: gh-pages
  skip-cleanup: true
  github-token: $GITHUB_TOKEN
  on:
    # only do this when on the master branch
    # Make sure this matches conf.py html_context["github_version"]
    branch: master